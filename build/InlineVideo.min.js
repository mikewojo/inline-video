!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("InlineVideo",[],e):"object"==typeof exports?exports.InlineVideo=e():t.InlineVideo=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1),a=n(r),u=i(2),d=n(u),h=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.src,o=void 0===n?"":n,r=i.parent,a=void 0===r?document.body:r,u=i.width,d=void 0===u?0:u,h=i.height,l=void 0===h?0:h,c=i.debug,f=void 0!==c&&c,p=i.onPlay,v=void 0===p?function(){}:p,m=i.onPause,y=void 0===m?function(){}:m,w=i.onEnded,b=void 0===w?function(){}:w;s(this,t),this.seek=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e.video.duration>0&&(t="number"==typeof t&&t<=e.video.duration?t:0,e.useRAF?e.audio.currentTime=t:e.video.currentTime=t),e},this.log=function(t){return e.debug&&console.log(t),e};var g=navigator.userAgent||navigator.vendor||window.opera;this.src=o,this.parent="string"==typeof a?document.querySelector(a):a,this.width=d,this.height=l,this.debug=f,this.onPlay=v,this.onPause=y,this.onEnded=b,this.audio=document.createElement("audio"),this.video=document.createElement("video"),this.states={STARTING:0,PREPPING:1,READY:2},this.state=this.states.STARTING,this.playing=!1,this.raf=null,this.iOS=!(!/iPhone|iPod/.test(g)||window.MSStream),this.supportsInline=!!("playsInline"in this.video),this.useRAF=!(!this.iOS||this.supportsInline),this.init()}return o(t,[{key:"init",value:function(){this.audio.addEventListener("canplay",this.prepAV.bind(this)),this.video.addEventListener("canplay",this.prepAV.bind(this)),this.audio.src=this.video.src=this.src,this.video.load(),this.parent.appendChild(this.video),this.iOS&&this.supportsInline&&!this.useRAF&&(this.log("[[ Using native inline player ]]"),this.video.setAttribute("playsinline",!0)),this.useRAF?(this.log("[[ Added inline player support ]]"),a.default.add(this.render.bind(this)),this.audio.addEventListener("ended",this.ended.bind(this)),this.addCSS()):(this.log("[[ Using regular HTML5 player ]]"),this.video.addEventListener("ended",this.ended.bind(this)))}},{key:"addCSS",value:function(){this.video.classList.add("InlineVideo"),d.default.addRule("\n\t\t\t.InlineVideo::-webkit-media-controls-play-button,\n\t\t\t.InlineVideo::-webkit-media-controls-start-playback-button {\n\t\t\t\tpointer-events: none;\n\t\t\t\topacity: 0;\n\t\t\t}\n\t\t")}},{key:"prepAV",value:function(){return this.state!==this.states.READY&&(this.state++,this.size(),this.state===this.states.READY&&this.playing&&this.play(),this)}},{key:"size",value:function(){return this.width="number"==typeof this.video.videoWidth&&0===this.width?this.video.videoWidth:this.width,this.height="number"==typeof this.video.videoHeight&&0===this.height?this.video.videoHeight:this.height,(0!==this.width||0!==this.height)&&(this.video.setAttribute("width",this.width+"px"),this.video.setAttribute("height",this.height+"px"),this)}},{key:"render",value:function(){this.video.currentTime=this.audio.currentTime}},{key:"load",value:function(){return this.audio.load(),this.size(),this}},{key:"play",value:function(){return this.playing=!0,this.video.classList.add("playing"),this.onPlay(),this.useRAF?this.state===this.states.READY?this.audio.play():this.load():this.video.play(),this}},{key:"pause",value:function(){return this.onPause(),this.useRAF?this.state===this.states.READY&&this.audio.pause():this.video.pause(),this.playing=!1,this.video.classList.remove("playing"),this}},{key:"ended",value:function(){this.video.classList.remove("playing"),this.onEnded()}}]),t}();e.default=h,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(){n(this,t),this.setup=!1,this.listeners=[],this.lastTime=0,this.timer={fps:60,before:Date.now(),now:0},this.prepare()}return s(t,[{key:"prepare",value:function(){for(var t=this,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),s=Math.max(0,16-(n-t.lastTime)),o=window.setTimeout(function(){e(n+s)},s);return t.lastTime=n+s,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),this.setup=!0,this.onLoop()}},{key:"onLoop",value:function(){this.timer.now=Date.now();var t=this.timer.now-this.timer.before;if(t>1e3/this.timer.fps)for(var e=0;e<this.listeners.length;e++)this.listeners[e]();this.timer.before=this.timer.now-t%(1e3/this.timer.fps),window.requestAnimationFrame(this.onLoop.bind(this))}},{key:"add",value:function(t){this.listeners.push(t)}},{key:"remove",value:function(t){var e=this.listeners.indexOf(t);this.listeners.splice(e,1)}}]),t}();e.default=new o,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function t(){var e=this;n(this,t),this.addRule=function(t){e.sheet.innerHTML+=t},this.sheet=document.createElement("style"),this.sheet.type="text/css",document.body.appendChild(this.sheet)};e.default=new s,t.exports=e.default}])});